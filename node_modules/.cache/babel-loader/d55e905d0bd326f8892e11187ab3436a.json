{"ast":null,"code":"import _objectSpread from\"/home/paulinho/Documentos/projectest/my-app/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _toConsumableArray from\"/home/paulinho/Documentos/projectest/my-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _slicedToArray from\"/home/paulinho/Documentos/projectest/my-app/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useEffect,useState,useContext}from'react';import ListMovies from\"./ListMovies\";import Box from'../../components/BoxFlex';import Button from'../../components/Button';import Results from'../../components/Results';import Loading from'../../components/Loading';import{SearchContext}from'../../contexts/Search';import{API_URL}from'../../services/url';import{jsx as _jsx}from\"react/jsx-runtime\";import{createElement as _createElement}from\"react\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var Movies=function Movies(){var _useContext=useContext(SearchContext),value=_useContext.value,currentPage=_useContext.currentPage,setCurrentPage=_useContext.setCurrentPage;var _useState=useState([]),_useState2=_slicedToArray(_useState,2),data=_useState2[0],setData=_useState2[1];var _useState3=useState(true),_useState4=_slicedToArray(_useState3,2),disabled=_useState4[0],setDisabled=_useState4[1];var _useState5=useState(true),_useState6=_slicedToArray(_useState5,2),loading=_useState6[0],setLoading=_useState6[1];var _useState7=useState({total_pages:14,total_results:262}),_useState8=_slicedToArray(_useState7,2),counts=_useState8[0],setCounts=_useState8[1];var upcoming=\"\".concat(API_URL,\"movie/upcoming?api_key=e9da1b9b1bf2935bf963f9c98fd51e01&language=en-US&page=\").concat(currentPage);var searching=\"\".concat(API_URL,\"search/movie?api_key=e9da1b9b1bf2935bf963f9c98fd51e01&language=en-US&query=\").concat(encodeURIComponent(value),\"&page=\").concat(currentPage);var hasPage=counts.total_pages>currentPage;var loadMoreItems=function loadMoreItems(){if(hasPage)setCurrentPage(function(page){return page+1;});};useEffect(function(){var endpoint=value===\"\"?upcoming:searching;setLoading(true);setDisabled(true);fetch(endpoint).then(function(response){return response.json();}).then(function(json){setData(function(previous){return currentPage===1?json.results:[].concat(_toConsumableArray(previous),_toConsumableArray(json.results));});setCounts({total_pages:json.total_pages,total_results:json.total_results});setDisabled(false);}).catch(function(error){return console.error(\"Error:\",error);}).finally(function(){return setLoading(false);});},[value,currentPage,searching,upcoming]);return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Results,{children:value?\"Resultados para: \".concat(value):\"Últimos lançamentos\"}),/*#__PURE__*/_jsx(Box,{children:data===null||data===void 0?void 0:data.map(function(movies){return/*#__PURE__*/_createElement(ListMovies,_objectSpread(_objectSpread({},movies),{},{key:movies.id}));})}),/*#__PURE__*/_jsx(Box,{children:loading&&/*#__PURE__*/_jsx(Loading,{})}),/*#__PURE__*/_jsx(Box,{children:hasPage?/*#__PURE__*/_jsx(Button,{onClick:loadMoreItems,disabled:disabled,children:\"Load More\"}):/*#__PURE__*/_jsxs(Results,{children:[\"Mostrando \",counts.total_results,\" de \",counts.total_results,\" Movies\"]})})]});};export default Movies;","map":{"version":3,"names":["useEffect","useState","useContext","ListMovies","Box","Button","Results","Loading","SearchContext","API_URL","Movies","value","currentPage","setCurrentPage","data","setData","disabled","setDisabled","loading","setLoading","total_pages","total_results","counts","setCounts","upcoming","searching","encodeURIComponent","hasPage","loadMoreItems","page","endpoint","fetch","then","response","json","previous","results","catch","error","console","finally","map","movies","id"],"sources":["/home/paulinho/Documentos/projectest/my-app/src/Pages/Movies/index.tsx"],"sourcesContent":["import { useEffect, useState, useContext } from 'react';\nimport ListMovies from \"./ListMovies\"\nimport Box from '../../components/BoxFlex'\nimport Button from '../../components/Button'\nimport Results from '../../components/Results'\nimport Loading from '../../components/Loading'\n\nimport { IMoviesProps } from '../../interfaces/MoviesProps'\n\nimport { SearchContext } from '../../contexts/Search';\nimport { API_URL, API_KEY } from '../../services/url'\n\n\nconst Movies = () => {\n  const { value, currentPage, setCurrentPage, } = useContext(SearchContext)\n  const [data, setData] = useState<IMoviesProps[]>([])\n  const [disabled, setDisabled] = useState(true)\n  const [loading, setLoading] = useState(true)\n  const [counts, setCounts] = useState({\n    total_pages: 14,\n    total_results: 262\n  });\n\n  const upcoming = `${API_URL}movie/upcoming?api_key=e9da1b9b1bf2935bf963f9c98fd51e01&language=en-US&page=${currentPage}`\n  const searching = `${API_URL}search/movie?api_key=e9da1b9b1bf2935bf963f9c98fd51e01&language=en-US&query=${encodeURIComponent(\n    value\n  )}&page=${currentPage}`\n\n  const hasPage = counts.total_pages > currentPage;\n\n  const loadMoreItems = () => {\n    if (hasPage) setCurrentPage((page) => page + 1)\n  };\n\n  useEffect(() => {\n    const endpoint =\n      value === \"\"\n        ? upcoming\n        : searching\n\n    setLoading(true)\n    setDisabled(true)\n    fetch(endpoint)\n      .then((response) => response.json())\n      .then((json) => {\n\n        setData((previous) =>\n          currentPage === 1 ? json.results : [...previous, ...json.results]\n        );\n\n        setCounts({\n          total_pages: json.total_pages,\n          total_results: json.total_results\n        });\n        setDisabled(false)\n      })\n      .catch((error) => console.error(\"Error:\", error))\n      .finally(() => setLoading(false))\n\n  }, [value, currentPage, searching, upcoming])\n\n  return (\n    <>\n      <Results>\n        {value ? `Resultados para: ${value}` : \"Últimos lançamentos\"}\n      </Results>\n\n      <Box>\n        {\n          data?.map(movies => (\n            <ListMovies {...movies} key={movies.id} />\n          ))\n        }\n      </Box>\n\n      <Box>\n        {loading && <Loading />}\n      </Box>\n\n      <Box>\n        {hasPage ? (\n          <Button onClick={loadMoreItems} disabled={disabled}>\n            Load More\n          </Button>\n        ) : (\n          <Results>\n            Mostrando {counts.total_results} de {counts.total_results} Movies\n          </Results>\n        )}\n      </Box>\n    </>\n  )\n}\n\nexport default Movies"],"mappings":"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"},"metadata":{},"sourceType":"module"}